# ESLint 9 Flat Config Migration Task

## Context
Filename: ESLint_9_Migration_Task.md
Created On: 2025-01-25
Created By: AI Assistant
Associated Protocol: RIPER-5 + Multidimensional + Agent Protocol

## Task Description
将现有的ESLint 8配置转换为ESLint 9的flat配置格式，并检查是否有其他需要修复的问题。

## Project Overview
该项目是一个基于ESLint的代码质量工具包，包含多个插件和配置包。当前使用ESLint 9.29.0但配置仍然是ESLint 8的格式。

---

## Analysis (Populated by RESEARCH mode)

### 当前配置分析：
- 使用ESLint 9.29.0但配置格式仍然是eslintrc
- 混合了ESLint和Prettier配置
- 使用了一些已废弃的规则如`@typescript-eslint/camelcase`和`@typescript-eslint/ban-ts-ignore`
- 包含自定义插件`@dz-web/eslint-plugin-esboot`
- 依赖多个第三方插件：TypeScript、React、Import等

### 主要问题：
1. 配置格式过时
2. 插件引用方式不兼容
3. 环境配置需要转换
4. 一些规则已废弃
5. Prettier集成导致配置冲突

## Proposed Solution (Populated by INNOVATE mode)

### 选择的方案：
完全重写为flat配置格式，同时分离ESLint和Prettier

### 优势：
- 充分利用ESLint 9新特性
- 避免配置冲突
- 提供更好的性能
- 为未来升级做准备

## Implementation Plan (Generated by PLAN mode)

### 实施检查清单：
1. ✅ 安装@eslint/js、globals、typescript-eslint依赖
2. ✅ 导入必需的ESLint和插件包
3. ✅ 配置languageOptions（globals、parser、parserOptions）
4. ✅ 设置plugins对象格式
5. ✅ 配置TypeScript文件的特定设置
6. ✅ 设置import resolver配置
7. ✅ 配置所有必需的rules
8. ✅ 设置ignores数组
9. ✅ 移除Prettier相关规则和插件
10. ✅ 更新esboot插件支持flat配置

## Task Progress (Appended by EXECUTE mode after each step completion)

### 2025-01-25
- Step: 1-10 (完整迁移)
- Modifications: 
  - 重写`packages/lint/config/eslint.js`为flat配置格式
  - 更新`packages/lint/package.json`依赖
  - 更新`packages/eslint-plugin-esboot/lib/index.js`支持flat配置
  - 移除废弃规则，修复已知问题
- Change Summary: 完全迁移到ESLint 9 flat配置格式
- Reason: 执行计划步骤1-10
- Blockers: None
- Status: Success
- User Confirmation Status: Success

### 2025-01-25 (Additional Fix)
- Step: 模块路径解析修复
- Modifications: 
  - 修改`packages/lint/config/eslint.js`使用`import.meta.resolve()`获取绝对路径
  - 添加回退机制确保兼容性
- Change Summary: 解决配置文件在不同项目中使用时的模块找不到问题
- Reason: 用户反馈配置会被复制到具体项目，需要使用绝对路径
- Blockers: None
- Status: Success
- User Confirmation Status: Success

### 2025-01-25 (ESM转换)
- Step: 转换ESLint插件规则为ESM格式
- Modifications: 
  - 转换`packages/eslint-plugin-esboot/lib/rules/no-cross-platform-imports.js`为ESM
  - 转换`packages/eslint-plugin-esboot/lib/rules/no-cross-platform-lib-imports.js`为ESM
  - 转换所有helper文件为ESM格式
  - 更新`packages/eslint-plugin-esboot/lib/index.js`使用ESM导入
  - 更新`packages/eslint-plugin-esboot/package.json`添加`"type": "module"`
  - 修复ESLint 9兼容性问题（使用`context.getFilename()`替代`context.filename`）
- Change Summary: 完全转换eslint-plugin-esboot为ESM格式并支持ESLint 9
- Reason: 用户要求转换为ESM格式并支持ESLint 9
- Blockers: None
- Status: Pending Confirmation

## Final Review (Populated by REVIEW mode)
[待完成] 